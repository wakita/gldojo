#!/bin/sh

export dojo_root=`pwd -L`
root() { cd "$dojo_root"/$1; }

export dojo_build=/tmp/build/`echo $dojo_root | sed -e "s|$HOME/||" -e "s|Dropbox[^/]*/||"`
build() { cd "$dojo_build"/$1; }
if [ ! -d "$dojo_build" ]; then mkdir -p `dirname "$dojo_build"`; fi

cmake -H. -B"$dojo_build" -G "Unix Makefiles"

make() { /usr/bin/make -C "$dojo_build" $* }
vmake() { make VERBOSE=1 $* }
distclean() { rm -rf "$dojo_build" }

export SHADERS_DIR="$dojo_root"/shaders
PATH="$dojo_build/bin:$dojo_build/bin/test:$PATH"

mvim() {
  (cd "$dojo_root"; /Applications/MacVim.app/Contents/MacOS/mvim -c "set makeprg=make\ -C\ \"$dojo_build\"" ./ $*)
}
